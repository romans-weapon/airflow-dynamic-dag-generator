from airflow import DAG
from datetime import datetime
from airflow.operators.python_operator import PythonOperator
from airflow.operators.http_operator import SimpleHttpOperator
import json

default_args= {
 'owner': 'Airflow POC',
 'depends_on_past': True,
 'email': '',
 'start_date': datetime(2020,1,1)
}

def my_function(x):
    return x + " is a must have tool for Data Engineers."

dag = DAG(
    dag_id="{{ dag_name }}_{{ dag_id }}",
    default_args=default_args,
    schedule_interval="{{ schedule_interval }}",
    catchup={{catchup or False}})

t1 = PythonOperator(
    task_id='python_task',
    python_callable=my_function,
    op_kwargs={"x": "Apache Airflow"},
    dag=dag
)

t2  = SimpleHttpOperator(
    task_id='get_response',
    method='GET',
    http_conn_id='random_http_conn',
    endpoint='/api/app/random_app',
    headers={"Content-Type": "application/json"},
    dag=dag
 )

t1 >> t2
